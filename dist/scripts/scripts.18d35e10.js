"use strict";angular.module("edurekaUiApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ui.router","ui.bootstrap","ngMaterial"]).factory("httpinterceptor",["$q","$location","$injector",function(a,b,c){return{request:function(a){return delete a.headers["content-type"],a}}}]).config(["$stateProvider","$urlRouterProvider","$httpProvider","$locationProvider",function(a,b,c,d){c.interceptors.push("httpinterceptor"),b.otherwise("/"),a.state("login",{url:"/",controller:"UserCtrl",templateUrl:"views/login.html"}).state("home",{"abstract":!0,url:"/home",controller:"HomeCtrl",templateUrl:"views/homepage.html"}).state("home.analysis",{url:"/analysis",controller:"HomeCtrl",templateUrl:"views/stats.html"}).state("home.entityAnalysis",{url:"/entityAnalysis",controller:"HomeCtrl",templateUrl:"views/entity-analysis.html"}).state("home.uploadForm",{url:"/upload",controller:"HomeCtrl",templateUrl:"views/upload-form.html"}).state("home.customEntities",{url:"/custom-entities",controller:"HomeCtrl",templateUrl:"views/custom-entities.html"}),d.hashPrefix("")}]),angular.module("edurekaUiApp").controller("UserCtrl",["$scope","userService","utilityService",function(a,b,c){a.login=function(d,e){if(d.$valid){a.pageLoader=!0;({userName:e.name,password:e.password});b.adminLogin(data).then(function(b){a.pageLoader=!1,localStorage.setItem("token",b.token),$state.go("adminSettings")},function(b){a.pageLoader=!1,c.showmdToast("error",b.message)})}}}]),angular.module("edurekaUiApp").controller("HomeCtrl",["$scope","$state","userService","utilityService",function(a,b,c,d){function e(a){var b=[];for(var c in a){var d=[];d.push(c),d.push(a[c]),b.push(d)}return console.log("chartList",b),{chartList:b}}a.upload=function(b,e,f){b.$valid&&(console.log("uploadData",e),a.pageLoader=!0,c.addWebinar(e).then(function(b){console.log("resp addWebinar",b),a.pageLoader=!1;var e=new FormData;$.each($("#uploadFile")[0].files,function(a,b){console.log("file",b),e.append("file",b,b.name)}),c.uploadExcel(e).then(function(b){console.log("resp upload",b),a.pageLoader=!1},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)})},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)}))},a.upload,a.getInstructors=function(){a.pageLoader=!0,c.getInstructors().then(function(b){a.pageLoader=!1,a.instructorList=b.data},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)})},a.getCourses=function(){a.pageLoader=!0,c.getCourses().then(function(b){a.pageLoader=!1,a.courseList=b.data},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)})},a.getCustomEntities=function(){a.pageLoader=!0,c.getCustomEntities().then(function(b){a.pageLoader=!1,console.log("resp",b),a.customEntities=b.data},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)})},a.getSessions=function(){a.pageLoader=!0,c.getSessions().then(function(b){a.pageLoader=!1,a.sessionList=b.data},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)})},a.getWebinars=function(){a.pageLoader=!0,c.getWebinars().then(function(b){a.pageLoader=!1,a.webinarList=b.data},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)})},a.openentityModal=function(b){$("#entityModal").modal(),a.courseKey=b,console.log("$scope.courseKey",a.courseKey)},a.addEntity=function(b,e){if(b.$valid){var f={course_key:a.courseKey,custom_entity:e.entity};c.addCustomEntity(f).then(function(b){a.pageLoader=!1,console.log("resp",b),a.getCustomEntities()},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)})}},a.showAnalysis=function(a,b){var c;"overAll"==a?(console.log("in overAll"),c={},f(c)):b&&(c=b,f(c))};var f=function(b){console.log("in getAnalysis",b),c.getAnalysis(b).then(function(b){a.pageLoader=!1,h(b.data)},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)})},g=function(b,e){console.log("in getAnalysis",b),c.getEntityAnalysis(b,e).then(function(b){console.log("resp",b),a.pageLoader=!1,i(b.data)},function(b){a.pageLoader=!1,d.showmdToast("error",b.message)})};a.entityAnalysis=function(a,b){var c;b&&b.course_key?"overAll"==a?(console.log("in overAll"),c={},g(c,b.course_key)):b&&(c=b,g(c,b.course_key)):d.showmdToast("error","Please select a course")};var h=function(a){var b,a=e(a);b=new Highcharts.Chart({chart:{renderTo:"pie-chart-container",type:"pie"},title:{text:""},yAxis:{title:{text:"Total percent market share"}},plotOptions:{pie:{shadow:!1}},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b>: "+this.y}},series:[{name:"Browsers",data:a.chartList,innerSize:"20%"}],credits:{enabled:!1}},function(b){var c=b.plotLeft+.5*b.plotWidth,d=b.plotTop+.5*b.plotHeight,e='<span id="pieChartInfoText" style="position:absolute; text-align:center;">';e+='<span style="font-size: 10px">Score</span><br>',e+='<span style="font-size: 26px">'+a.innersize+"</span>",e+="</span>",$("#addText").append(e),e=$("#pieChartInfoText"),e.css("left",c+e.width()*-.5),e.css("top",d+e.height()*-.5)})},i=function(a){Highcharts.chart("bar-chart-container",{chart:{type:"column"},xAxis:{type:"category"},yAxis:{title:{text:"percentage"}},legend:{enabled:!1},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y:.1f}%"}}},credits:!1,tooltip:{headerFormat:"",pointFormat:'<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}%</b> of total<br/>'},series:[{name:"Brands",colorByPoint:!0,data:a}]})};b.is("home.stats")&&setTimeout(function(){},100)}]),angular.module("edurekaUiApp").service("userService",["$q","$http",function(a,b){this.login=function(c){var d=a.defer();return b({method:"POST",url:API_END_POINT+"/user/login",data:c}).then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},this.getInstructors=function(){console.log("getInstructors");var c=a.defer();return b({method:"GET",url:API_END_POINT+"/get_instructors"}).then(function(a){c.resolve(a.data)},function(a){c.reject(a.data)}),c.promise},this.getCourses=function(){var c=a.defer();return b({method:"GET",url:API_END_POINT+"/get_courses"}).then(function(a){c.resolve(a.data)},function(a){c.reject(a.data)}),c.promise},this.addWebinar=function(c){var d=a.defer();return b({method:"POST",url:API_END_POINT+"/add_new_session",data:c}).then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},this.addWebinar=function(c){var d=a.defer();return b({method:"POST",url:API_END_POINT+"/add_new_session",data:c}).then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},this.uploadExcel=function(c){var d=a.defer();return b({method:"POST",url:API_END_POINT+"/add_webinar_report",data:c,headers:{"Content-Type":void 0}}).then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},this.addCustomEntity=function(c){var d=a.defer();return b({method:"POST",url:API_END_POINT+"/add_custom_entity",data:c}).then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},this.getCustomEntities=function(){var c=a.defer();return b({method:"GET",url:API_END_POINT+"/get_custom_entities"}).then(function(a){c.resolve(a.data)},function(a){c.reject(a.data)}),c.promise},this.getSessions=function(c){var d=a.defer();return b({method:"GET",url:API_END_POINT+"/get_sessions"}).then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},this.getWebinars=function(){var c=a.defer();return b({method:"GET",url:API_END_POINT+"/get_webinars"}).then(function(a){c.resolve(a.data)},function(a){c.reject(a.data)}),c.promise},this.getAnalysis=function(c){var d=a.defer();return b({method:"POST",url:API_END_POINT+"/get_analysis",data:c}).then(function(a){d.resolve(a.data)},function(a){d.reject(a.data)}),d.promise},this.getEntityAnalysis=function(c,d){var e=a.defer();return b({method:"POST",url:API_END_POINT+"/get_entity_analysis/"+d,data:c}).then(function(a){e.resolve(a.data)},function(a){e.reject(a.data)}),e.promise}}]),angular.module("edurekaUiApp").service("utilityService",["$mdToast",function(a){this.showmdToast=function(b,c){a.show(a.simple({textContent:c,hideDelay:3e3,position:"top right",toastClass:b}))}}]),angular.module("edurekaUiApp").directive("ngFileModel",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.ngFileModel),f=d.multiple,g=e.assign;c.bind("change",function(){var a=[];angular.forEach(c[0].files,function(b){var c={name:b.name,size:b.size,url:URL.createObjectURL(b),_file:b};a.push(c)}),b.$apply(function(){f?g(b,a):g(b,a[0])})})}}}]),angular.module("edurekaUiApp").run(["$templateCache",function(a){a.put("views/custom-entities.html",'<div class="main-container" ng-init="getCourses();getCustomEntities();"> <div class="entities-container"> <uib-accordion close-others="true" class="acc-job"> <div uib-accordion-group class="panel acc-head" ng-repeat="(key,value) in customEntities" is-open="page.open" style="cursor:default"> <uib-accordion-heading> <div class="clearfix cust-entity-head"> <p class="inline-middle">{{key}}</p> <i class="pull-right fa fa-minus" ng-if="page.open"></i> <i class="pull-right fa fa-plus" ng-if="!page.open"></i> <button type="text" class="blue-btn pull-right" ng-click="openentityModal(value.course_key);">ADD</button> </div> </uib-accordion-heading> <div class="pos-relative"> <div class="text-left cust-entity" ng-repeat="entity in value.custom_entities">{{entity.custom_entity}}</div> </div> </div> </uib-accordion> </div> <div class="modal fade" tabindex="-1" role="dialog" id="entityModal"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">ADD ENTITIES</h4> </div> <form name="enityForm"> <div class="modal-body entity-form"> <div class="ip-form-group clearfix"> <span>Web Id</span> <input class="custom-ip" placeholder="Enter Custom Entity" type="text" required name="entity" ng-model="entityData.entity"> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> <button type="button" class="btn blue-btn" ng-click="addEntity(enityForm,entityData)">Add</button> </div> </form> </div> </div> </div> </div>'),a.put("views/entity-analysis.html",'<div class="main-container" ng-init="getInstructors();getCourses();getSessions();getWebinars();"> <div> <div> <p class="inline-middle chart-filters"> <span>Course</span> <select name="course" ng-options="course._key as course.name for course in courseList" ng-model="entityFilterData.course_key"></select> </p> <button class="blue-btn" ng-click="entityAnalysis(\'overAll\',entityFilterData)">Overall Analysis</button> </div> <div class="chart-filters-content"> <p class="chart-filter-head">Filters</p> <p class="inline-middle chart-filters"> <span>Instructor</span> <select name="instructor" ng-options="instructor._key as instructor.name for instructor in instructorList" ng-model="entityFilterData.instructor_key"></select> </p> <!-- <p class="inline-middle chart-filters">	\n				<span>Session</span>\n				<select name="session" ng-options="session._key as session.name for session in sessionList" ng-model="entityFilterData.session_key"></select>\n			</p>\n			<p class="inline-middle chart-filters">\n				<span>Webinar</span>\n				<select name="webinar" ng-options="webinar._key as webinar._key for webinar in webinarList" ng-model="entityFilterData.webinar_key"></select>\n			</p> --> <button class="blue-btn" ng-click="entityAnalysis(\'filter\',entityFilterData)">Show Analysis</button> </div> </div> <div style="width: 70%;margin: 0 auto"> <div id="bar-chart-container"></div> </div> </div>'),a.put("views/header.html",'<div class="clearfix header-container"> <h4 class="text-center margin-none"> Edureka <button class="signout-btn pull-right" ng-click="signOut();"><i class="fa fa-power-off" aria-hidden="true"></i>SIGN OUT</button> </h4> </div> <div class="empty-div"></div>'),a.put("views/homepage.html",'<div> <div ng-include="\'views/header.html\'"></div> <div class="clearfix"> <div class="side-panel"> <div> <p style="padding-left:10px;padding-top: 10px;font-size: 18px">Pages</p> <li class="side-panel-li" ui-sref-active="active" ui-sref="home.analysis">Analysis</li> <li class="side-panel-li" ui-sref-active="active" ui-sref="home.entityAnalysis">Entity Analysis</li> <li class="side-panel-li" ui-sref-active="active" ui-sref="home.uploadForm">Upload</li> <li class="side-panel-li" ui-sref-active="active" ui-sref="home.customEntities">Custom Entities</li> </div> </div> <section ui-view autoscroll="false" style="background-color: #fff;margin-left: 20%"> Looding...... </section> <div class="loader" ng-show="pageLoader"> <md-progress-circular md-mode="indeterminate" class="center-box"></md-progress-circular> </div> </div> </div>'),a.put("views/login.html",'<div class="loader" ng-show="pageLoader"> <md-progress-circular md-mode="indeterminate" class="center-box"></md-progress-circular> </div> <div class="login-container"> <div class="login-content"> <form name="loginForm"> <p> <input name="name" type="text" placeholder="User name" required ng-model="user.name" autocomplete="new-password"> </p> <p> <input name="password" type="password" placeholder="Password" required ng-model="user.password" autocomplete="new-password"> </p> <p> <button class="blue-btn" ng-click="Login(loginForm,user)">Login</button> </p> </form> </div> </div>'),a.put("views/stats.html",'<div class="main-container" ng-init="getInstructors();getCourses();getSessions();getWebinars();"> <div> <div> <button class="blue-btn" ng-click="showAnalysis(\'overAll\')">Overall Analysis</button> </div> <div class="chart-filters-content"> <p class="chart-filter-head">Filters</p> <p class="inline-middle chart-filters"> <span>Instructor</span> <select name="instructor" ng-options="instructor._key as instructor.name for instructor in instructorList" ng-model="filterData.instructor_key"></select> </p> <p class="inline-middle chart-filters"> <span>Course</span> <select name="course" ng-options="course._key as course.name for course in courseList" ng-model="filterData.course_key"></select> </p> <p class="inline-middle chart-filters"> <span>Session</span> <select name="session" ng-options="session._key as session.name for session in sessionList" ng-model="filterData.session_key"></select> </p> <p class="inline-middle chart-filters"> <span>Webinar</span> <select name="webinar" ng-options="webinar._key as webinar._key for webinar in webinarList" ng-model="filterData.webinar_key"></select> </p> <button class="blue-btn" ng-click="showAnalysis(\'filter\',filterData)">Show Analysis</button> </div> </div> <div style="width: 70%;margin: 0 auto"> <div id="pie-chart-container"></div> </div> </div>'),a.put("views/upload-form.html",'<div class="main-container" ng-init="getInstructors();getCourses();"> <div class="form-container"> <form action="" name="uploadForm"> <div class="ip-form-group clearfix"> <span>Course</span> <select name="course" ng-options="course._key as course.name for course in courseList" ng-model="uploadData.course_key" required></select> </div> <div class="ip-form-group clearfix"> <span>Instructor</span> <select name="instructor" ng-options="instructor._key as instructor.name for instructor in instructorList" ng-model="uploadData.instructor_key" required></select> </div> <div class="ip-form-group clearfix"> <span>Web Id</span> <input type="text" name="webId" ng-model="uploadData.webinar_id" required> </div> <div class="ip-form-group clearfix"> <span>Name</span> <input type="text" name="name" ng-model="uploadData.name" required> </div> <!-- <div>\n				<span>Upload File</span>\n				<input type="file" ng-file-model="files" multiple />\n    			<button type="button" ng-click="upload()">Upload</button>\n				<p ng-repeat="file in files">\n			      {{file.name}}\n			    </p>\n			</div> --> </form> <form id="fileUpload" ng-submit="upload(uploadForm, uploadData)" enctype="multpart/form-data"> <div class="file-ip-group"> <span>Upload Files</span> <div class="file-ip pos-relative"> <button type="text" class="blue-btn" style="width:100%">Choose Files</button> <!-- <input type="file" name="file" type=".xlsx" ng-file-model="files" multiple> --> <input id="uploadFile" type="file" name="file" ng-file-model="files" multiple> </div> <p ng-repeat="file in files"> {{file.name}} </p> <!-- <button class="blue-btn" ng-if="files.length" type="submit">Upload</button> --> <button class="blue-btn" type="submit">Upload</button> </div> </form> </div> </div>')}]);